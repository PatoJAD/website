<div class="w-full mb-4">
	<h3 class="text-2xl text-amber-500 font-bold mb-2 bg-gray-100 dark:bg-gray-800 p-4 rounded-xl text-center">{{ .Site.Params.donate.title }}</h3>

	{{ $items := .Site.Params.donate.main }}

		<style>
			/* minimal CSS for dynamic brand color using CSS variable */
			.donate-tile {
				transition: background-color .18s ease, color .18s ease;
			}
			.donate-icon { color: var(--brand); }
			.donate-tile:hover .donate-icon { color: #fff !important; }
			.donate-tile:hover { background-color: var(--brand) !important; }
		</style>

	<div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3">
		{{ range $i, $d := $items }}
			{{ $isBig := eq $i 0 }}
			{{ $classes := (cond $isBig "md:col-span-2 md:row-span-2 aspect-square" "aspect-square") }}
			{{ $brand := "#4B5563" }}{{ with $d.params.color }}{{ $brand = . }}{{ end }}
			<div style="--brand: {{ $brand }};" class="donate-tile relative rounded-xl overflow-hidden shadow-lg flex items-center justify-center p-4 {{ $classes }} bg-gray-100 dark:bg-gray-800">
				{{/* If crypto, open modal; else link out */}}
				{{ $isCrypto := false }}{{ with $d.params.is_crypto }}{{ $isCrypto = . }}{{ end }}
				{{ if $isCrypto }}
								<button type="button" data-wallet="{{ $d.url }}" aria-label="{{ $d.name }}" class="w-full h-full flex flex-col items-center justify-center donate-action" >
									<em class="donate-icon {{ $d.params.icon }} text-4xl mb-2" aria-hidden="true"></em>
									<span class="text-sm text-center">{{ $d.name }}</span>
								</button>
				{{ else }}
								<a href="{{ $d.url }}" target="_blank" rel="noopener" aria-label="{{ $d.name }}" class="w-full h-full flex flex-col items-center justify-center">
									<em class="donate-icon {{ $d.params.icon }} text-4xl mb-2" aria-hidden="true"></em>
									<span class="text-sm text-center">{{ $d.name }}</span>
								</a>
				{{ end }}
			</div>
		{{ end }}
	</div>

	<!-- Modal (hidden by default) -->
	<div id="donate-modal" class="fixed inset-0 z-50 hidden items-center justify-center bg-black/40">
		<div class="bg-white dark:bg-gray-800 rounded-xl shadow-xl w-11/12 max-w-md p-6">
			<h4 class="text-lg font-semibold mb-3">Direcci√≥n de la billetera</h4>
			<div id="donate-address" class="break-words bg-gray-100 dark:bg-gray-900 p-3 rounded-xl mb-4"></div>
			<div class="flex justify-end gap-2">
				<button id="donate-copy" class="px-3 py-2 bg-amber-500 text-white rounded-xl">Copiar</button>
				<button id="donate-close" class="px-3 py-2 bg-gray-200 dark:bg-gray-700 rounded-xl">Cerrar</button>
			</div>
		</div>
	</div>

	<script>
		(function(){
			const modal = document.getElementById('donate-modal');
			const addr = document.getElementById('donate-address');
			const copyBtn = document.getElementById('donate-copy');
			const closeBtn = document.getElementById('donate-close');

			function openModal(address){
				addr.textContent = address;
				modal.classList.remove('hidden');
				modal.classList.add('flex');
			}

			function closeModal(){
				modal.classList.add('hidden');
				modal.classList.remove('flex');
			}

			document.querySelectorAll('.donate-action').forEach(btn => {
				btn.addEventListener('click', (e) => {
					const address = btn.getAttribute('data-wallet') || '';
					openModal(address);
				});
			});

			copyBtn.addEventListener('click', ()=>{
				const text = addr.textContent || '';
				if(!text) return;
				navigator.clipboard && navigator.clipboard.writeText(text);
				copyBtn.textContent = 'Copiado';
				setTimeout(()=> copyBtn.textContent = 'Copiar', 2000);
			});
			closeBtn.addEventListener('click', closeModal);
			modal.addEventListener('click', (e)=>{ if(e.target===modal) closeModal(); });
		})();
	</script>

</div>